DECLARE @startdate SMALLDATETIME, @enddate SMALLDATETIME SET @startdate = '07/01/2019 00:00' SET @enddate = '07/31/2019 23:59' SELECT od.productcode, od.productname, Sum(od.quantity) AS QuantitySold, Sum(od.totalprice) AS Revenue FROM orderdetails AS od WITH (NOLOCK) INNER JOIN orders AS o WITH (NOLOCK) ON o.orderid = od.orderid WHERE o.orderstatus <> 'Cancelled' AND o.orderstatus <> 'Returned' AND od.productcode NOT LIKE '%ship%' AND od.productcode NOT LIKE '%resid%' AND od.productcode NOT LIKE '%resdent%' AND od.productcode NOT LIKE '%resid%' AND od.productcode NOT LIKE '%res del%' AND od.productcode NOT LIKE '%deli%'AND od.productcode NOT LIKE '%frei%' AND od.productcode NOT LIKE '%truck%' AND od.productcode NOT LIKE '%gate%' AND od.productcode NOT LIKE '%farm%' AND od.productcode NOT LIKE '%home%' AND od.productcode NOT LIKE '%extrafrt%' AND od.productcode NOT LIKE '%extarfrt%' AND od.productcode NOT LIKE '%extra frt%' AND od.productcode NOT LIKE '%2 day%' AND od.productcode NOT LIKE '%2nd%' AND od.productcode NOT LIKE '%next%' AND od.productcode NOT LIKE '%miles%' AND od.productcode NOT LIKE '%tax%' AND od.productcode NOT LIKE '%expedite%' AND od.productcode NOT LIKE '%ground%' AND od.productcode NOT LIKE '%fedex%' AND od.productcode NOT LIKE '%UPS%' AND od.productcode NOT LIKE '%USPS%' AND od.productcode NOT LIKE '%resconsignment%' AND od.productcode NOT LIKE '%res.%' AND od.productcode NOT LIKE '%overnight%' AND od.productcode NOT LIKE 'DSC-%' AND o.orderdate BETWEEN @startdate AND @enddate GROUP BY od.productcode, od.productname ORDER BY QuantitySold ASC
